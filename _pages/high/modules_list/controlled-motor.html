<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Controlled motor - Luos.io - Documentation</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Luos official documentation pages">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
        <link rel="stylesheet" href="../../../src/_assets/css/custom.css">
        

        
    </head>
    <body>
	
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>
		
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

		<nav id="sidebar" class="sidebar" aria-label="Table of contents">
			<div id="sidebar-scrollbox" class="sidebar-scrollbox">
				<!--<a href="https://www.luos.io"><img src="/_assets/img/luos_logo_100px.png" height="50px" />--><ol class="chapter"><li class="affix "><a href="../../../index.html">Home</a></li><li class=""><a href="../../../_pages/overview/general-basics.html"><strong aria-hidden="true">1.</strong> Luos overview</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/overview/general-basics.html"><strong aria-hidden="true">1.1.</strong> Basics</a></li><li class=""><a href="../../../_pages/overview/general-start.html"><strong aria-hidden="true">1.2.</strong> How to start</a></li></ol></li><li class=""><a href="../../../_pages/low/low-level.html"><strong aria-hidden="true">2.</strong> Low level</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/low/dev-env.html"><strong aria-hidden="true">2.1.</strong> Development environment</a></li><li class=""><a href="../../../_pages/low/electronic-design.html"><strong aria-hidden="true">2.2.</strong> Electronic design</a></li><li class=""><a href="../../../_pages/low/modules.html"><strong aria-hidden="true">2.3.</strong> Modules</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/low/modules/create-project.html"><strong aria-hidden="true">2.3.1.</strong> Create Luos projects</a></li><li class=""><a href="../../../_pages/low/modules/create-modules.html"><strong aria-hidden="true">2.3.2.</strong> Create Luos modules</a></li><li class=""><a href="../../../_pages/low/modules/apps.html"><strong aria-hidden="true">2.3.3.</strong> Luos apps</a></li><li class=""><a href="../../../_pages/low/modules/drivers.html"><strong aria-hidden="true">2.3.4.</strong> Luos drivers</a></li><li class=""><a href="../../../_pages/low/modules/od.html"><strong aria-hidden="true">2.3.5.</strong> Object dictionary</a></li><li class=""><a href="../../../_pages/low/modules/routing-table.html"><strong aria-hidden="true">2.3.6.</strong> Routing table</a></li><li class=""><a href="../../../_pages/low/modules/msg-handling.html"><strong aria-hidden="true">2.3.7.</strong> Messages handling</a></li><li class=""><a href="../../../_pages/low/modules/rt-config.html"><strong aria-hidden="true">2.3.8.</strong> Real-time configuration</a></li><li class=""><a href="../../../_pages/low/modules/modules-list.html"><strong aria-hidden="true">2.3.9.</strong> Code Examples</a></li></ol></li></ol></li><li class="expanded "><a href="../../../_pages/high/high-level.html"><strong aria-hidden="true">3.</strong> High level</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/high/json-api.html"><strong aria-hidden="true">3.1.</strong> JSON API</a></li><li class=""><a href="../../../_pages/high/pyluos.html"><strong aria-hidden="true">3.2.</strong> Pyluos</a></li><li class="expanded "><a href="../../../_pages/high/modules-list.html"><strong aria-hidden="true">3.3.</strong> Modules list</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/high/modules_list/gate.html"><strong aria-hidden="true">3.3.1.</strong> Gate</a></li><li class=""><a href="../../../_pages/high/modules_list/angle.html"><strong aria-hidden="true">3.3.2.</strong> Angle</a></li><li class=""><a href="../../../_pages/high/modules_list/color.html"><strong aria-hidden="true">3.3.3.</strong> Color</a></li><li class="expanded "><a href="../../../_pages/high/modules_list/controlled-motor.html" class="active"><strong aria-hidden="true">3.3.4.</strong> Controlled motor</a></li><li class=""><a href="../../../_pages/high/modules_list/dc-motor.html"><strong aria-hidden="true">3.3.5.</strong> DC motor</a></li><li class=""><a href="../../../_pages/high/modules_list/distance.html"><strong aria-hidden="true">3.3.6.</strong> Distance</a></li><li class=""><a href="../../../_pages/high/modules_list/dxl.html"><strong aria-hidden="true">3.3.7.</strong> Dynamixel motor</a></li><li class=""><a href="../../../_pages/high/modules_list/imu.html"><strong aria-hidden="true">3.3.8.</strong> IMU</a></li><li class=""><a href="../../../_pages/high/modules_list/light.html"><strong aria-hidden="true">3.3.9.</strong> Light</a></li><li class=""><a href="../../../_pages/high/modules_list/servo.html"><strong aria-hidden="true">3.3.10.</strong> Servo motor</a></li><li class=""><a href="../../../_pages/high/modules_list/state.html"><strong aria-hidden="true">3.3.11.</strong> State</a></li><li class=""><a href="../../../_pages/high/modules_list/stepper.html"><strong aria-hidden="true">3.3.12.</strong> Stepper motor</a></li><li class=""><a href="../../../_pages/high/modules_list/voltage.html"><strong aria-hidden="true">3.3.13.</strong> Voltage</a></li></ol></li></ol></li><li class=""><a href="../../../_pages/prototyping_boards/electronic-use.html"><strong aria-hidden="true">4.</strong> Prototyping boards</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/prototyping_boards/electronic-use.html"><strong aria-hidden="true">4.1.</strong> Boards general use</a></li><li class=""><a href="../../../_pages/prototyping_boards/quick-start.html"><strong aria-hidden="true">4.2.</strong> Quick start</a></li><li class=""><a href="../../../_pages/prototyping_boards/update-module-firmware.html"><strong aria-hidden="true">4.3.</strong> Update firmware</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards-list.html"><strong aria-hidden="true">4.4.</strong> Boards list</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/prototyping_boards/boards_list/button.html"><strong aria-hidden="true">4.4.1.</strong> Button</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/battery-power-input.html"><strong aria-hidden="true">4.4.2.</strong> Battery power input</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/controlled-motor.html"><strong aria-hidden="true">4.4.3.</strong> Controlled motor</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/dc-motor.html"><strong aria-hidden="true">4.4.4.</strong> DC motor</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/distance.html"><strong aria-hidden="true">4.4.5.</strong> Distance sensor</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/dxl.html"><strong aria-hidden="true">4.4.6.</strong> Dynamixel motor</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/gpio.html"><strong aria-hidden="true">4.4.7.</strong> GPIO</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/imu.html"><strong aria-hidden="true">4.4.8.</strong> IMU</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/jack-power-input.html"><strong aria-hidden="true">4.4.9.</strong> Jack power input</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/light.html"><strong aria-hidden="true">4.4.10.</strong> Light sensor</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/potentiometer.html"><strong aria-hidden="true">4.4.11.</strong> Potentiometer</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/power-isolator.html"><strong aria-hidden="true">4.4.12.</strong> Power isolator</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/powerpi.html"><strong aria-hidden="true">4.4.13.</strong> Power Pi</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/powerswitch.html"><strong aria-hidden="true">4.4.14.</strong> Power switch</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/rgbled.html"><strong aria-hidden="true">4.4.15.</strong> RGB LED</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/servo.html"><strong aria-hidden="true">4.4.16.</strong> Servo motor</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/stepper.html"><strong aria-hidden="true">4.4.17.</strong> Stepper motor</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/usb.html"><strong aria-hidden="true">4.4.18.</strong> USB</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/wifible.html"><strong aria-hidden="true">4.4.19.</strong> Wifi BLE</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/wire-power-input.html"><strong aria-hidden="true">4.4.20.</strong> Wire power input</a></li><li class=""><a href="../../../_pages/prototyping_boards/boards_list/cables.html"><strong aria-hidden="true">4.4.21.</strong> Cables</a></li></ol></li></ol></li><li class=""><a href="../../../_pages/development_boards/dev-board-list.html"><strong aria-hidden="true">5.</strong> Development boards</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class=""><a href="../../../_pages/development_boards/l0-dev.html"><strong aria-hidden="true">5.1.</strong> L0 dev</a></li><li class=""><a href="../../../_pages/development_boards/breakout.html"><strong aria-hidden="true">5.2.</strong> Luos breakout</a></li></ol></li></ol>
			<a class="cust_menu_item" href="https://www.luos.io" target="_blank">Go to Luos.io</a>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
				
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <a href="https://www.luos.io"><img src="/_assets/img/luos_logo_100px.png" height="50px" /></a>
						<button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>
					
					<h1 class="menu-title">Luos.io - Documentation</h1>

                    <div class="right-buttons">
                        <a href="https://www.luos.io" class="cust_menu_top">Luos.io</a>&nbsp;&nbsp;<a href="../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#controlled-motor-module-type" id="controlled-motor-module-type">Controlled-motor module type</a></h1>
<p>This module type allows to control a motor with a reduction and a sensor (usually called motor-reducer or speed-reducer).
This module computes PID for speed, position and motion planning.</p>
<p>You can find basic information about PID control here: <a href="https://medium.com/luosdeviceics/an-introduction-to-pid-control-with-dc-motor-1fa3b26ec661" target="_blank">An introduction to PID control with DC motor</a>, and a code example to tune your PID at the end of this page.</p>
<p>Its type has access to all common capabilities.</p>
<h3><a class="header" href="#moduless-type-settings" id="moduless-type-settings">Modules’s type settings:</a></h3>
<blockquote>
<p><strong>Warning:</strong> This module doesn't save any of the following parameters, they must be set each time your module reboots.</p>
</blockquote>
<p>Before using your controlled motor module, you have to setup the resolution, motor reduction and eventually the wheel size, if you plan to use translation modes. To check the configuration, just make a complete turn on the motor shaft with your hand and check if the rotation position value is OK.</p>
<p>Both PID’s values have to be set accordingly to the motor-reducer plugged to the board. Each different motor-reducer will have different PID’s values for position and speed control, and you have to define them by yourself.
The default values <code>[0, 0, 0]</code> won’t have any effect on the motor, and must be changed if you plan to use any position or speed control mode.
To setup your PID please refer to the example at the end of this page.</p>
<blockquote>
<p><strong>Warning:</strong> PID for position and speed must be set in your code as an initialization before starting to use your module with position or speed control.</p>
</blockquote>
<p>Now that everything is configured, you can enable the control modes you want to use. You can use position and speed mode simultaneously. Power mode is only usable alone. The controlled motor is now ready to use, you can disable compliance to start moving the motor.</p>
<hr />
<h2><a class="header" href="#functions" id="functions">Functions</a></h2>
<table><thead><tr><th align="center"><strong>Function name and parameters</strong></th><th align="center"><strong>Action</strong></th><th align="center"><strong>Comment</strong></th></tr></thead><tbody>
<tr><td align="center">setToZero(self)</td><td align="center">Resets current position of the motor to 0</td><td align="center">You can use it to initialize the position of the motor</td></tr>
<tr><td align="center">control(self)</td><td align="center">Displays module type graphical interface</td><td align="center">Only available using Jupyter notebook</td></tr>
</tbody></table>
<h2><a class="header" href="#variables" id="variables">Variables</a></h2>
<h3><a class="header" href="#motor-settings" id="motor-settings">Motor settings</a></h3>
<table><thead><tr><th align="center"><strong>Variable name</strong></th><th align="center"><strong>Action</strong></th><th align="center"><strong>Type</strong></th></tr></thead><tbody>
<tr><td align="center">positionPid</td><td align="center">Sets position PID used for rotation position mode and translation position mode</td><td align="center">read / write: [float P, float I, float D]</td></tr>
<tr><td align="center">speedPid</td><td align="center">Sets speed PID used for rotation speed mode and translation speed mode</td><td align="center">read / write: [float P, float I, float D]</td></tr>
<tr><td align="center">encoder_res</td><td align="center">Defines the motor sensor resolution, in steps by rotation.<br/><em>This module considers that the sensor is placed before the reduction. If it's not your case, just setup a reduction ratio of 1.</em></td><td align="center">read / write: float</td></tr>
<tr><td align="center">reduction</td><td align="center">Defines the motor reduction.<br/>Set this value to 1 if your sensor measures after the reduction.</td><td align="center">read / write: float</td></tr>
<tr><td align="center">wheel_size</td><td align="center">Defines wheel size used for translation mode, in mm.</td><td align="center">read / write: float</td></tr>
</tbody></table>
<h3><a class="header" href="#motor-control-modes" id="motor-control-modes">Motor control modes</a></h3>
<table><thead><tr><th align="center"><strong>Variable name</strong></th><th align="center"><strong>Action</strong></th><th align="center"><strong>Type</strong></th></tr></thead><tbody>
<tr><td align="center">compliant</td><td align="center">- True: disables the motor driver, you can use it to move the motor by hand.<br/> - False: Enables the motor driver.</td><td align="center">read / write: Boolean (True or False)</td></tr>
<tr><td align="center">power_mode</td><td align="center">Enables/Disables the power control mode.<br/><em>Disables any other control mode if enabled.</em></td><td align="center">read / write: Boolean (True or False)</td></tr>
<tr><td align="center">rot_position_mode</td><td align="center">Enables/Disables the motor rotation position control mode.<br/><em>Disables power mode and translation position mode if enabled.</em><br/><em>Doesn't work if no position PID is configured.</em></td><td align="center">read / write: Boolean (True or False)</td></tr>
<tr><td align="center">rot_speed_mode</td><td align="center">Enables/Disables the motor rotation speed control mode.<br/><em>Disables power mode and translation speed mode if enabled.</em><br/><em>Doesn't work if no speed PID configured.</em></td><td align="center">read / write: Boolean (True or False)</td></tr>
<tr><td align="center">trans_position_mode</td><td align="center">Enables/Disables the motor translation position control mode.<br/><em>Disables power mode and rotation position mode if enabled.</em><br/><em>Doesn't work if no position PID configured.</em></td><td align="center">read / write: Boolean (True or False)</td></tr>
<tr><td align="center">trans_speed_mode</td><td align="center">Enables/Disables the motor translation speed control mode.<br/><em>Disables power mode and rotation speed mode if enabled.</em><br/><em>Doesn't work if no speed PID configured.</em></td><td align="center">read / write: Boolean (True or False)</td></tr>
</tbody></table>
<h3><a class="header" href="#motor-sensing" id="motor-sensing">Motor sensing</a></h3>
<table><thead><tr><th align="center"><strong>Variable name</strong></th><th align="center"><strong>Action</strong></th><th align="center"><strong>Type</strong></th></tr></thead><tbody>
<tr><td align="center">rot_position</td><td align="center">Reads rotation position in °<br/><em>Reading it auto-Enables actualization.</em></td><td align="center">read only: float</td></tr>
<tr><td align="center">rot_position</td><td align="center">Starts/Stops rotation position measurement actualization</td><td align="center">write only: Boolean (True or False)</td></tr>
<tr><td align="center">rot_speed</td><td align="center">Reads rotation speed in °/s<br/><em>Reading it auto-Enables actualization.</em></td><td align="center">read only: float</td></tr>
<tr><td align="center">rot_speed</td><td align="center">Starts/Stops rotation speed measurement actualization</td><td align="center">write only: Boolean (True or False)</td></tr>
<tr><td align="center">trans_position</td><td align="center">Reads translation position in mm<br/><em>Reading it auto-Enables actualization.</em></td><td align="center">read only: float</td></tr>
<tr><td align="center">trans_position</td><td align="center">Starts/Stops translation position measurement actualization</td><td align="center">write only: Boolean (True or False)</td></tr>
<tr><td align="center">trans_speed</td><td align="center">Reads translation speed in mm/s<br/><em>Reading it auto-enables actualization.</em></td><td align="center">read only: float</td></tr>
<tr><td align="center">trans_speed</td><td align="center">Starts/Stops translation speed measurement actualization</td><td align="center">write only: Boolean (True or False)</td></tr>
<tr><td align="center">current</td><td align="center">Reads the current consumption in A<br/><em>Reading it auto-enables actualization.</em></td><td align="center">read only: float</td></tr>
<tr><td align="center">current</td><td align="center">Starts/Stops current measurement actualization</td><td align="center">write only: Boolean (True or False)</td></tr>
</tbody></table>
<h3><a class="header" href="#motor-commands" id="motor-commands">Motor commands</a></h3>
<table><thead><tr><th align="center"><strong>Variable name</strong></th><th align="center"><strong>Action</strong></th><th align="center"><strong>Type</strong></th></tr></thead><tbody>
<tr><td align="center">power_ratio</td><td align="center">Sets the power quantity send to the motor between -100% and 100%.</td><td align="center">read / write: float</td></tr>
<tr><td align="center">target_rot_position</td><td align="center">Sets the target rotation position to reach in °.</td><td align="center">read / write: float</td></tr>
<tr><td align="center">target_rot_speed</td><td align="center">Sets the target rotation speed to reach in °/s.</td><td align="center">read / write: float</td></tr>
<tr><td align="center">target_trans_position</td><td align="center">Sets the target translation position to reach in mm.</td><td align="center">read / write: float</td></tr>
<tr><td align="center">target_trans_speed</td><td align="center">Sets the target translation speed to reach in mm/s.</td><td align="center">read / write: float</td></tr>
</tbody></table>
<h2><a class="header" href="#pid-setting-example-code" id="pid-setting-example-code">PID Setting example code</a></h2>
<p>The PID values allow your motor to stick to the target command as fast as possible. The quality of a set of PID values depends on time to reach the target position and position precision.
Tuning a PID is something difficult and takes a lot of practice. It's really important to have simple ways to evaluate PID values impact on your motor before starting to tune these values.
Here is the code we use at Luos to tune a PID by ourself. Use it with Jupyter notebook to get your plot instantly.</p>
<p>The main code:</p>
<pre><code class="language-python">%matplotlib inline
from pyluos import Device
from IPython.display import clear_output
import time
import matplotlib
matplotlib.use('TkAgg')
import matplotlib.pyplot as plt

# 1. Connect your Luos network (here using an USB module for example)
r = Device('/dev/cu.usbserial-DN2AAOVK')
r.modules

# 2. Select the module of your network you need to configure
module = r.controlled_moto

# 3. Setup module basic settings
module.encoder_res = 48
module.reduction = 26.851

def run_speed_test(velocity_target):
    module.rot_position = False
    module.rot_speed = True
    module.rot_position_mode = False
    module.rot_speed_mode = True
    module.target_rot_speed = 0.0
    module.compliant = False
    target = []
    real = []
    test_time_vector = []
    test_start_time = time.time()
    target.append(module.target_rot_speed)
    real.append(module.rot_speed)
    test_time = time.time()
    test_time_vector.append(0.0)
    while (test_time &lt; test_start_time + 0.5):
        target.append(module.target_rot_speed)
        real.append(module.rot_speed)
        test_time_vector.append(test_time - test_start_time)
        test_time = time.time()
    module.target_rot_speed = velocity_target
    while (test_time &lt; test_start_time + 2.5):
        target.append(module.target_rot_speed)
        real.append(module.rot_speed)
        test_time_vector.append(test_time - test_start_time)
        test_time = time.time()
    module.compliant = True
    plot_test(test_time_vector, target, real)

def run_pos_test(pos_target):
    module.rot_speed = False
    module.rot_position = True
    module.rot_speed_mode = False
    module.rot_position_mode = True
    module.target_rot_position = 0.0
    module.compliant = False
    target = []
    real = []
    test_time_vector = []
    test_start_time = time.time()
    target.append(module.target_rot_position)
    real.append(module.rot_position)
    test_time = time.time()
    test_time_vector.append(0.0)
    while (test_time &lt; test_start_time + 1):
        target.append(module.target_rot_position)
        real.append(module.rot_position)
        test_time_vector.append(test_time - test_start_time)
        test_time = time.time()
    module.target_rot_position = pos_target
    while (test_time &lt; test_start_time + 2.5):
        target.append(module.target_rot_position)
        real.append(module.rot_position)
        test_time_vector.append(test_time - test_start_time)
        test_time = time.time()
    module.compliant = True
    plot_test(test_time_vector, target, real)

def plot_test(test_time_vector, target, real):
    fig = plt.figure()
    ax = plt.subplot(111)
    ax.plot(test_time_vector,target,'r')
    ax.plot(test_time_vector,real,'b')
    plt.show()
    plt.close(fig)
</code></pre>
<p>Now, you are ready to tune the PID values for position and speed control modes. To do that, you have to try values to get best the result possible. In order to succeed, we advise you to do it step by step:</p>
<ol>
<li>Set P, I, and D values to 0.</li>
<li>Increase the P value until you have a small oscillation around the target.</li>
<li>Increase the D value until you have a fast and stable position.</li>
<li>Increase with really small figures the I value to improve the motor precision.</li>
</ol>
<p>The code you can use to tune your speed PID:</p>
<pre><code class="language-python"># Speed PID settings
module.speedPid = [0.1,0.1,0] # speed PID [P, I, D]
run_speed_test(100.0)
</code></pre>
<p>The code you can use to tune your position PID:</p>
<pre><code class="language-python"># Position PID settings
module.positionPid = [4.0,0.02,100] # position PID [P, I, D]
run_pos_test(100.0)
</code></pre>
<div class="cust_edit_page"><a href="https://github.com/Luos-io/doc/tree/master/src/_pages/high/modules_list/controlled-motor.md">Edit this page</a></div>
<br /><div class="cust_footer"><hr style="border: 1px dotted #ddd;"><p align="center">©2018-2020 <a href="https://www.luos.io">Luos.io</a></p></div>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../../_pages/high/modules_list/color.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../../_pages/high/modules_list/dc-motor.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../../../_pages/high/modules_list/color.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../../../_pages/high/modules_list/dc-motor.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        
        <!-- Google Analytics Tag -->
        <script type="text/javascript">
            var localAddrs = ["localhost", "127.0.0.1", ""];

            // make sure we don't activate google analytics if the developer is
            // inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-153509818-3', 'auto');
                ga('send', 'pageview');
            }
        </script>
        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
